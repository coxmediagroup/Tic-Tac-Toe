<html>
<head>
<title>TicTacToe Xtreme 2014!</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-2.1.1-rc2.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

<script>
$('document').ready(function(){

	var getMatrix = function(){

		// var tiles = '[{"1":2, "2":2, "3":1, "4":1, "5":2, "6":2, "7":2, "8":0, "9":1}]';
		var tiles = {
			1:parseInt($('#1').attr('data-owner')),
			2:parseInt($('#2').attr('data-owner')),
			3:parseInt($('#3').attr('data-owner')),
			4:parseInt($('#4').attr('data-owner')),
			5:parseInt($('#5').attr('data-owner')),
			6:parseInt($('#6').attr('data-owner')),
			7:parseInt($('#7').attr('data-owner')),
			8:parseInt($('#8').attr('data-owner')),
			9:parseInt($('#9').attr('data-owner'))
		};

		tiles = JSON.stringify(tiles);
		
		console.log(tiles);

		// var test = '{"1":2, "2":2, "3":1, "4":1, "5":2, "6":2, "7":2, "8":0, "9":1}';

		return tiles;
	}
	
	function resetBoard(){
		$('.tile').each(function(){
			$(this).removeClass('comp')
			.removeClass('player')
			.attr('data-owner', 0)
			.text('');
			$('.band').each(function(){
				$(this).hide();
			});
		});
	}

	$('.chess').click(function(){
		alert('Sorry, Deep Blue is sleeping.');
	});

	$('.wargames').click(function(){
		alert('Sorry, JOSHUA v0.6b is not operational.');
	});

	$('.restart').click(function(){
		resetBoard();
	});

	$('.tile').click(function(){

		if($(this).attr('data-owner') == 0){
			$(this).attr('data-owner','2');
			$(this).addClass('player').text('X');
			//var tdata = $(this).attr('id');
			var tdata = getMatrix();

			$.ajax({
				type: "POST",
				url: "HTTP://127.0.0.1:8052",
				data: tdata,
				dataType: "text"
			})
			.done(function( data ){
				data = JSON.parse(data);
				console.log(data);
				target = '#' + data.move;
				$(target).addClass('comp').attr('data-owner','1').text('O');

				if(data.type == 'win'){
					$('#win').show();
				}

				else if(data.type == null || data.type == 'cat'){
					$('#cat').show();
					// alert('cat');
				}


			})
			.fail(function( data, msg, err ){
				alert("hmmm.... Something wrong here! ") + err;
			});
		} else {
			alert('No Cheating!');
		}

	});

	$('#end').click(function(){
		$.ajax({
			type: "DELETE",
			url: "HTTP://127.0.0.1:8052",
			dataType: "text",
			data: "",
			complete: function(){
				//alert("It is finished!");
				window.close();
			}
		});
	});

});
</script>
<style>
	body {
		font-family: Arial;
		background: #a67ba8; /* Old browsers */
		background: -moz-linear-gradient(top,  #a67ba8 26%, #ffa87a 100%); /* FF3.6+ */
		background: -webkit-gradient(linear, left top, left bottom, color-stop(26%,#a67ba8), color-stop(100%,#ffa87a)); /* Chrome,Safari4+ */
		background: -webkit-linear-gradient(top,  #a67ba8 26%,#ffa87a 100%); /* Chrome10+,Safari5.1+ */
		background: -o-linear-gradient(top,  #a67ba8 26%,#ffa87a 100%); /* Opera 11.10+ */
		background: -ms-linear-gradient(top,  #a67ba8 26%,#ffa87a 100%); /* IE10+ */
		background: linear-gradient(to bottom,  #a67ba8 26%,#ffa87a 100%); /* W3C */
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#a67ba8', endColorstr='#ffa87a',GradientType=0 ); /* IE6-9 */

		color:#333;
		text-align:center;
	}

	h1 {
		font-size:54px;
		color:#fff;
		margin:0px;
	}

	a {
		color:#cdcdcd;
		text-decoration: none;
	}

	a:hover {
		color:#fff;
	}

	#container {
		clear:both !important;
		width:505px;
		margin-right:auto;
		margin-left:auto;
		margin-top:100px;
		background:#ff0000;

		-webkit-box-shadow: 3px 6px 25px 1px rgba(0,0,0,0.75);
		-moz-box-shadow: 3px 6px 25px 1px rgba(0,0,0,0.75);
		box-shadow: 3px 6px 25px 1px rgba(0,0,0,0.75);
	}

	.tile {
		border:#fff 1px solid;
		width:160px;
		height:160px;
		float:left;
		box-sizing;border-box;
		padding: 0px 0px 0px 0px;
		font-size:140px;
		overflow:hidden;
		color:#fff;
	}

	.player {
		background:rgba(256, 156, 0, 0.2);
	}

	.comp {
		background:rgba(256, 0, 156, 0.2);
	}

	.clearfix {
		clear:both;
	}

	button {
		background:rgba(256, 256, 256, 0.3);
		border:none;
		font-size:24px;
	}

	button:hover {
		background:rgba(256, 256, 256, 0.7);
	}

	.band {
		background:rgba(80, 0, 80, 0.8);
		color:#fff;
		font-size:18px !important;
		position:absolute;
		top:270px;
		width:100%;
		display:none;
	}

	.band h2 {
		font-size:90px;
		margin:0px !important;
	}

	.band .int {
		width:760px;
		margin: 0px auto 0px auto;
		padding:20px;
	}
	.band button {

	}


	footer {
		font-size:10px;
		color:#fff;
		position:absolute;
		bottom:10px;
		text-align: center;
		width:100%;
	}
</style>
</head>